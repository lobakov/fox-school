USE BATCH?

Пакетное выполнение запросов

Существует возможность отправлять не только отдельные запросы, но и группировать запросы на изменение данных в пакеты (Batch). В примере ниже мы группируем 10 операций INSERT в один пакет и разом отправляем его на выполнение:
private static void psBatchEx() {
   try (PreparedStatement prepInsert = connection.prepareStatement("INSERT INTO students (name, score) VALUES (?, ?)")) {
       for (int i = 1; i <= 10; i++) {
           prepInsert.setString(1, "Bob" + i);
           prepInsert.setInt(2, i * 10 % 100);
           prepInsert.addBatch();
       }
       int[] result = prepInsert.executeBatch();
   } catch (SQLException e) {
       e.printStackTrace();
   }
}

Или можно то же самое сделать через Statement:

private static void stmtBatchEx() {
   try {
       for (int i = 1; i <= 10; i++) {
           Statement stmt = connection.createStatement();
           stmt.addBatch(String.format("INSERT INTO students (name, score) VALUES (%s, %d)", "Bob" + i, i * 10 % 100));
       }
       int[] result = stmt.executeBatch();
   } catch (SQLException e) {
       e.printStackTrace();
   }
}
